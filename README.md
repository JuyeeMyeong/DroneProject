# 6 DOF 드론 구현 프로젝트

이 프로젝트는 언리얼 엔진에서 6DOF를 갖는 드론을 구현하는 데에 초점을 맞추어 제작되었습니다. 
커스텀 `UDroneMovementComponent`를 사용하여, 플레이어는 드론과 유사한 Pawn을 6DOF로 조종할 수 있습니다.
이 드론을 조종하여 플레이어는 제한된 공간에서 웨이브별로 아이템을 수집하고, 점수/시간/체력을 관리하면서 최종 생존을 목표로 하는 게임입니다.

---

## 목차
- [필수 과제](#필수-과제)  
  - [웨이브 구성 및 전환](#웨이브-구성-및-전환)  
  - [핵심 게임 정보 UI](#핵심-게임-정보-ui)  
  - [메뉴 레이아웃](#메뉴-레이아웃)  
- [구현 상세](#구현-상세)  
  - [웨이브 설정 데이터 테이블](#웨이브-설정-데이터-테이블)  
  - [델리게이트(Broadcast) 시스템](#델리게이트broadcast-시스템)  
  - [UI: 머티리얼 기반 프로그레스 바](#ui-머티리얼-기반-프로그레스-바)  
  - [HUD & 애니메이션](#hud--애니메이션)  
  - [웨이브 매니저 & 스폰 볼륨](#웨이브-매니저--스폰-볼륨)  
  - [플레이어 체력바 & 아이템 알림](#플레이어-체력바--아이템-알림)  
- [도전 과제](#도전-과제)
  - [난이도 조정 / 확장성 설계](#난이도-조정-/-확장성-설계)
  - [UI 디자인](#UI-디자인)
- [6DOF 드론 구현 (7번과제)](#주요-기능)  
  - [드론의 물리 기반 이동 시스템](#드론의-물리-기반-이동-시스템)  
  - [입력 처리 순서](#입력-처리-순서)  
  - [물리 파라미터 설명](#물리-파라미터-설명)  

---

## 필수 과제

### 웨이브 구성 및 전환
- **3단계 웨이브**(Wave 1~3)로 구성  
- 웨이브 시작 시 **아이템 스폰** 및 **타이머**가 초기화  
- 제한 시간 종료 시 **자연스럽게 다음 웨이브**로 전환  
- **체력 0 시 즉시 게임 종료**

### 핵심 게임 정보 UI
- 한 화면에서 **점수**, **남은 시간**, **체력**을 모두 확인  
- 플레이 중 실시간으로 **데이터 갱신**
- 체력바와 타이머는 Animated Progress Bar 형태로 제작 

### 메뉴 레이아웃
- 기본 메뉴(레벨 이동 / 재시작 / 종료) 구성  
- 버튼 클릭 시 **레벨 전환**, **재시작**, **게임 종료** 정상 동작  

---

## 구현 상세

### 웨이브 설정 데이터 테이블
- **DT_WaveConfig** 데이터 테이블 사용  
  - `WaveIndex`: 스테이지 번호  
  - `TimeLimit`: 해당 웨이브 제한 시간  
  - `SpawnCount`: 스폰할 아이템 개수  
- **Wave 2**에서는 번개 아이템 추가, **Wave 3**에서는 시야 축소 디버프 구현

### 델리게이트(Broadcast) 시스템
- **웨이브 시작/종료**, **제한시간**, **스테이지 정보**를 델리게이트로 브로드캐스트  
- 모든 웨이브 종료 시 `WaveIndex = 0`을 반환하여 게임 종료 알림  
- **체력**, **점수** 변화도 델리게이트로 실시간 통지하여 UI 업데이트

### UI: 머티리얼 기반 프로그레스 바
- 체력바, 타이머 등 **프로퍼티 비율(0~1)**에 따라 **머티리얼**으로 구현  
- 머티리얼 파라미터와 Tick을 활용하여 조정하면 자연스러운 바 애니메이션

### HUD & 애니메이션
- **HUD**, **게임 종료 화면**에 **Fade In** 애니메이션 적용  
- 버튼 **Hover** 시 **디자인 변경** 추가  

### 웨이브 매니저 & 스폰 볼륨
- **Wave Manager** 클래스가 전체 스폰 로직 제어  
- 월드에 배치된 여러 **SpawnVolume** 중 랜덤 위치 선택 후 아이템 스폰 

### 플레이어 체력바 & 아이템 알림
- 체력바는 캐릭터 머리에 **WidgetComponent**로 부착  
- 체력 변화 시 해당 머티리얼 프로그레스 바 업데이트  
- 아이템 사용 시 HUD 왼쪽 상단에 **사용 알림** 표시  

---

## 도전 과제

### 난이도 조정 / 확장성 설계
1. 웨이브가 올라갈수록 **스폰 개수·확률·아이템 종류·디버프** 변경
2. 새로운 웨이브/디버프/이벤트 추가 시 Data Table로 아이템을 추가하고, 아이템 사용 기능만 추가하면 사용 가능한 **재사용 가능한 구조** 확보  

### UI 디자인
- **폰트**, **색상**, **아이콘** 등 HUD·메뉴 전반에 통일된 스타일 적용 
- **3D UI**: WidgetComponent로 캐릭터 머리 위 체력바 및 상호작용 안내  
- UI 배경, 애니메이션에 **고유 디자인 요소** 적용
- 게임 플레이 ↔ UI 조작 전환 시 **마우스 커서 보이기/숨기기**  
- **SetInputModeGameOnly** / **SetInputModeUIOnly** 호출

---

## 주요 기능 

- **드론 전용 Pawn 클래스 (`ADronePlayer`)**
  - 6자유도 조종 (이동, 회전, 롤링)
  - Spring Arm을 통한 3인칭 카메라 지원
  - 충돌 감지를 위한 Sphere Collision 사용
 
  
- **사용자 정의 이동 컴포넌트 (`UDroneMovementComponent`)**
  - 중력 인식 이동 및 공중 제어 계수
  - 추력 기반 이동 및 감속 처리
  - Sweep 기반 지면 감지
  - 커스텀 충돌 반응 및 슬라이딩 처리
 
---

## 드론의 물리 기반 이동 시스템

`UDroneMovementComponent`는 물리 기반 이동 시스템으로, 아래의 요소들을 계산하여 Pawn의 이동과 회전 등을 처리합니다.

- 입력 기반 추력
- 중력 및 항력 계산
- 지면 접촉 여부 반영
- 속도 감속 보간
- 회전 및 각속도 적용

## 입력 처리 순서 

1. **입력 처리**: 지면 여부에 따라 입력 보정  
2. **추력 계산**: 방향별 추력 + 중력 + 항력 적용  
3. **속도 갱신**: 가속도를 적용한 속도 계산  
4. **이동 적용**: `SafeMoveUpdatedComponent()`로 위치 갱신  
5. **충돌 처리**: 슬라이딩 벡터 계산 및 반영  
6. **회전 처리**: 각속도에 따른 회전 적용  
7. **지면 감지**: Sphere Sweep을 통한 접지 상태 확인  
8. **입력 초기화**: 다음 프레임을 위한 입력값 초기화

---

## 물리 파라미터 설명 
| 변수명                 | 타입       | 카테고리         | 설명 |
|------------------------|------------|------------------|------|
| `Mass`                 | float      | DronePhysics      | 드론의 질량 |
| `Gravity`              | float      | DronePhysics      | 중력 가속도 (엔진에서 받아옴) |
| `MaxThrustForce`       | float      | DronePhysics      | 수평 방향 최대 추력 |
| `MaxVerticalThrust`    | float      | DronePhysics      | 수직 방향 최대 추력 |
| `DragCoefficient`      | float      | DronePhysics      | 속도에 따른 항력 계수 |
| `DampingSpeed`         | float      | DronePhysics      | 입력이 없을 때 속도 감속 보간 계수 |
| `MaxSpeed`             | float      | DronePhysics      | 최대 속도 제한 |
| `AirControlFactor`     | float      | DronePhysics      | 공중 제어 민감도 (지면에 비해 감소) |
| `GroundCheckDistance`  | float      | Ground Check      | 지면 감지 거리 (Sweep 수행 거리) |
| `bIsOnGround`          | bool       | 내부 사용         | 드론이 지면에 있는지 여부 |

---

자세한 드론 물리 관련 설명은 아래의 Notion 링크를 확인해주시길 바랍니다. 
https://www.notion.so/22bdba07f02e8061953fd1675630b65d?source=copy_link

---

